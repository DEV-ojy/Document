# 자연어 처리를 위한 1D CNN(1D Convolutional Neural Networks)

이번챕터에서는 합성곱 신경망을 자연어 처리에서 사용하기 위한 1D CNN을 이해해보겠습니다 

## 1.2D 합성곱 

합성곱 신경망은 자연어 처리보다는 이미지나 영상 처리와 같은 비전 분야에 사용되는 것으로 좀 더 잘 알려져있습니다 

2D 합성곱은 합성곱 연산을 통해서 이미지의 특징을 추출하는 역할을 합니다 성곱은 영어로 컨볼루션이라고도 불리는데, 커널(kernel) 또는 필터(filter)라는 n x m 크기의 행렬로 높이 x 너비 크기의 이미지를 처음부터 끝까지 겹치며 훑으면서 n x m 크기의 겹쳐지는 부분의 각 이미지와 커널의 원소의 값을 곱해서 모두 더한 값을 출력으로 하는 것을 말합니다

이때, 이미지의 가장 왼쪽 위부터 가장 오른쪽까지 순차적으로 훑습니다 

* 커널(kernel)은 일반적으로 3 × 3 또는 5 × 5를 사용합니다.

예를 통해 이해해봅시다 아래는 3x3 크기의 커널로 5x5의 이미지 행렬에 합성곱 연산을 수행하는 과정을 보여줍니다 한 번의 연산을 1 스텝이라고 하였을 때, 합성곱 연산의 네번째 스텝까지 이미지와 식으로 표현해봤습니다 

![image](https://user-images.githubusercontent.com/80239748/136969952-ead722d9-0968-47a0-bb50-380954695179.png)

![image](https://user-images.githubusercontent.com/80239748/136970048-f4e2e8ec-758b-4454-ae80-0cfcb3a8dbf4.png)

위 연산을 총 9번의 스텝까지 마쳤다고 가정하였을 때, 최종 결과는 아래와 같습니다 

![image](https://user-images.githubusercontent.com/80239748/136970281-154d143d-bb5a-4aaf-a9bb-32b0d65f77ee.png)

위와 같이 입력으로부터 커널을 사용하여 합성곱 연산을 통해 나온 결과를 **특성 맵(feature map)** 이라고 합니다 

위 예제에서는 커널의 크기가 3 x 3이었지만 커널의 크기는 사용자가 정할 수 있습니다 또한 커널의 이동 범위가 위의 예제에서는 한 칸 이었지만 이 또한 사용자가 정할 수 있습니다 이러한 이동 범위를 **스트라이드(stride)** 라고 합니다 

아래의 예제는 스트라이드가 2일 경우에 5x5이미지에 합성곱 연산을 수행하는 3 x 3커널의 움직임을 보여줍니다 최종적으로 2 x 2의 크기의 특성 맵을 얻습니다 

![image](https://user-images.githubusercontent.com/80239748/136970831-b7f17938-9c68-452f-a8a0-3f0759810fbe.png)



