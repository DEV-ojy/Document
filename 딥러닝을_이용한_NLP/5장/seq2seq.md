# 시퀀스-투-시퀀스(Sequence-to-Sequence, seq2seq)

시퀀스-투-시퀀스는 입력된 시퀀스로부터 다른 도메인의 시퀀스를 출력하는 다양한 분야에서 사용되는 모델입니다 예를 들어 챗봇과 기계번역이 그러한 대표적인 예인데 입력 시퀀스와 출력 시퀀스를 각각 질문과 대답으로 구성하면 챗봇으로 만들 수 있고, 입력 시퀀스와 출력 시퀀스를 각각 입력 문장과 번역문장으로 만들면 번역기로 만들 수 있습니다 
그 외에도 내용 요약,STT등에서 쓰일수 있습니다 

이번에는 기계번역을 예제로 시퀀스-투-시퀀스를 설명해보겠습니다 

## 1. 시퀀스-투-시퀀스(Sequence-to-Sequence)

seq2seq는 번역기에서 대표적으로 사용되는 모델입니다 앞으로의 설명 방식은 내부가 보이지 않는 커다란 블랙 박스에서 점차적으로 확대해가는 방식으로 설명합니다 

고로 여기서 설명하는 내용의 대부분은 RNN 챕터에서 언급한 내용들입니다 단지 이것을 가지고 어떻게 조립했느냐에 따라서 seq2seq라는 구조가 만들어집니다

![image](https://user-images.githubusercontent.com/80239748/144242713-ca80a2de-372f-4848-8fdb-16a3073ea63f.png)

위의 그림은 seq2seq 모델로 만들어진 번역기가 'I am a student'라는 영어 문장을 입력받아서, 'je suis étudiant'라는 프랑스 문장을 출력하는 모습을 보여줍니다

그렇다면, seq2seq 모델 내부의 모습은 어떻게 구성되었을까요

![image](https://user-images.githubusercontent.com/80239748/144242827-4ff4271e-39b6-4aa8-8ee9-ebb2960eef61.png)

seq2seq는 크게 두 개로 구성된 아키텍처로 구성되는데, 바로 인코더와 디코더입니다 

인코더는 입력 문장의 모든 단어들을 순차적으로 입력받은 뒤에 마지막에 이 모든 단어 정보들을 압축해서 하나의 벡터로 만드는데, 이를 컨텍스트 벡터(context vector)라고 합니다

입력 문장의 정보가 하나의 컨텍스트 벡터로 모두 압축되면 인코더는 컨텍스트 벡터를 디코더로 전송합니다 디코더는 컨텍스트 벡터를 받아서 번역된 단어를 한 개씩 순차적으로 출력합니다

![image](https://user-images.githubusercontent.com/80239748/144242951-f94951cd-c252-45e8-9ed8-2099f48592e9.png)

컨텍스트 벡터에 대해서는 뒤에서 다시 언급하겠습니다 위의 그림에서는 컨텍스트 벡터를 4의 사이즈로 표현하였지만, 실제 현업에서 사용되는 seq2seq 모델에서는 보통 수백 이상의 차원을 갖고있습니다 

이제 인코더와 디코더의 내부를 좀 더 확대해보겠습니다.

![image](https://user-images.githubusercontent.com/80239748/144243111-70344edc-881b-41ee-a011-2324c9948913.png)


