## 텐서조작하기

이어서 텐서를 조작하는 방법을 알아보겠습니다

#### 4. 뷰(View)-원소의 수를 유지하면서 텐서의 크기 변경 
파이토치 텐서의 뷰는 넘파이에서의 리쉐이프와 같은 역할을 합니다 
RESHAPE라는 이름에서 알 수 있듯이 텐서의 크기를 변경해주는 역할을 합니다

임의로 다음과 같이 3차원 텐서를 만듭니다

```
t = np.array([[[0, 1, 2],
               [3, 4, 5]],
              [[6, 7, 8],
               [9, 10, 11]]])
ft = torch.FloatTensor(t)
```

ft라는 이름의 3차원 텐서를 만들었습니다 크기를 확인해보겠습니다

```
print(ft.shape)
torch.Size([2, 2, 3])
```

현재 위 텐서의 크기는 (2,2,3)입니다

#### 4-1) 3차원 텐서에서 2차원 텐서로 변경

이제 ft 텐서를 view를 사용하여 크기를 2차원 텐서로 변경해봅시다

```
print(ft.view([-1, 3])) # ft라는 텐서를 (?, 3)의 크기로 변경
print(ft.view([-1, 3]).shape)
tensor([[ 0.,  1.,  2.],
        [ 3.,  4.,  5.],
        [ 6.,  7.,  8.],
        [ 9., 10., 11.]])
torch.Size([4, 3])
```
view([-1,3])이 가지는 의미는 이와 같습니다 -1은 첫번째 차원을 사용자가 잘 모르겠으니 파이토치에 맡기겠다는 의미이고 
3은 두번째 차원의 길이는 3을 가지도록 하라는 의미입니다 다시 말해 현재 3차원 텐서를 2차원 텐서로 변경하되 (?,3)의
크기로 변경하라는 의미입니다  결과적으로 (4,3)의 크기를 가지는 텐서를 얻었습니다

내부적으로 크기 변환은 다음과 같이 이루어졌습니다 (2,2,3) -> (2x2,3)-> (4,3)

규칙을 정리해봅시다
* view는 기본적으로 변경 전과 변경 후의 텐서 안의 원소의 개수가 유지되어야 합니다
* 파이토치의 view는 사이즈가 -1로 설정되면 다른 차원으로부터 해당 값을 유추합니다 

변경 전 텐서의 원소의 수는 (2x2x3)으로 12개였습니다 그리고 변경후 텐서의 원소의 개수 또한 (4x3)으로 12개 였습니다


#### 4-2) 3차원 텐서의 크기 변경

이번에는 3차원 텐서에서 3차원 텐서로 차원은 유지하되, 크기(shape)를 바꾸는 작업을 해보겠습니다. view로 텐서의 크기를 변경하더라도 원소의 수는 유지되어야 한다고 언급한 바 있습니다. 그렇다면 (2 × 2 × 3) 텐서를 (? × 1 × 3) 텐서로 변경하라고 하면 ?는 몇 차원인가요?

(2 × 2 × 3) = (? × 1 × 3) = 12를 만족해야 하므로 ?는 4가 됩니다. 이를 실습으로 확인해봅시다.

```
print(ft.view([-1, 1, 3]))
print(ft.view([-1, 1, 3]).shape)
tensor([[[ 0.,  1.,  2.]],

        [[ 3.,  4.,  5.]],

        [[ 6.,  7.,  8.]],

        [[ 9., 10., 11.]]])
torch.Size([4, 1, 3])
```


#### 5) 스퀴즈(Squeeze) - 1인 차원을 제거한다.
스퀴즈는 차원이 1인 경우에는 해당 차원을 제거합니다.
실습을 위해 임의로 (3 × 1)의 크기를 가지는 2차원 텐서를 만들겠습니다.

```
ft = torch.FloatTensor([[0], [1], [2]])
print(ft)
print(ft.shape)
tensor([[0.],
        [1.],
        [2.]])
torch.Size([3, 1])
```
해당 텐서는 (3 × 1)의 크기를 가집니다. 두번째 차원이 1이므로 squeeze를 사용하면 (3,)의 크기를 가지는 텐서로 변경됩니다.

```
print(ft.squeeze())
print(ft.squeeze().shape)
tensor([0., 1., 2.])
torch.Size([3])
```
위의 결과는 1이었던 두번째 차원이 제거되면서 (3,)의 크기를 가지는 텐서로 변경되어 1차원 벡터가 된 것을 보여줍니다.


